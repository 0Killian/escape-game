<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <title>Escape Game - Salle</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            .host {
                color: #ffd700;
            }
            .error {
                color: #ff4444;
                margin-top: 10px;
            }

            /* Bouton retour - adaptatif selon la sc√®ne */
            #backToMenuBtn {
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                border: 4px solid #fff;
                box-shadow:
                    0 6px 0 #2e7d32,
                    0 8px 15px rgba(0, 0, 0, 0.4);
                transition: transform 0.15s ease, box-shadow 0.15s ease;
            }

            #backToMenuBtn:hover {
                transform: translateY(2px);
            }

            #backToMenuBtn:active {
                transform: translateY(4px);
            }
        </style>
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    </head>
    <body>
        <div
            id="waiting-room"
            class="flex items-center justify-center min-h-screen bg-[url('/assets/images/waiting_room_bg.jpg')] bg-cover bg-center"
        >
            <div
                class="film-container relative w-[500px] h-[340px] bg-black flex flex-col overflow-hidden shadow-[0_10px_30px_rgba(0,0,0,0.7)] pt-2 pb-2"
            >
                <!-- Perforations du haut -->
                <div
                    id="top-perforations"
                    class="film-perforations top absolute left-0 right-0 h-5 bg-black z-10 flex justify-between px-2 top-0"
                ></div>

                <div
                    class="section top-section flex flex-col items-center justify-center h-[50px] bg-[#0a0a0a] border-b border-[#333] p-3 text-white"
                >
                    <div
                        id="code-display"
                        class="code-display font-mono text-xl font-bold text-[#ffcc00] text-center tracking-[0.2em]"
                    ></div>
                </div>

                <div
                    class="section middle-section flex-1 bg-[#111] border-b border-[#333] p-3 text-white"
                >
                    <h2
                        class="section-title w-fit font-mono text-[#ffcc00] text-base uppercase tracking-wider mb-2 font-bold"
                    >
                        Acteurs
                    </h2>
                    <div
                        class="section-content h-[60%] flex flex-col justify-center text-[#e0e0e0] text-sm leading-relaxed"
                    >
                        <ul id="players-list" class="list-disc ml-6"></ul>
                        <div id="status" class="mt-2"></div>
                        <div class="error" id="errorMsg"></div>
                    </div>
                </div>

                <div class="bottom-sections flex h-[80px]">
                    <div
                        class="section bottom-center flex-1 bg-[#151515] flex justify-center items-center p-0"
                    >
                        <button
                            id="startBtn"
                            class="film-button bg-gradient-to-br from-[#ffcc00] to-[#ff9900] text-black border-none px-4 py-2 font-mono font-bold text-sm uppercase tracking-wide rounded cursor-pointer transition-all duration-300 shadow-md hover:from-[#ff9900] hover:to-[#ffcc00] hover:-translate-y-0.5 hover:shadow-lg active:translate-y-0 active:shadow-md"
                        >
                            Commencer
                        </button>
                    </div>
                </div>

                <!-- Perforations du bas -->
                <div
                    id="bottom-perforations"
                    class="film-perforations bottom absolute left-0 right-0 h-5 bg-black z-10 flex justify-between px-2 bottom-0"
                ></div>
            </div>
        </div>
        <!-- Bouton retour au menu principal (fl√®che) -->
        <button
            id="backToMenuBtn"
            class="fixed top-0 left-0 w-[56px] h-[56px] z-[1001] flex items-center justify-center cursor-pointer transition-all duration-150 rounded-br-[16px]"
        >
            <svg
                width="28"
                height="28"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M19 12H5M5 12L12 19M5 12L12 5"
                    stroke="white"
                    stroke-width="3"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                />
            </svg>
        </button>
        <!-- Bouton flottant chat -->
        <button
            id="chatBtn"
            class="fixed bottom-[32px] right-[32px] w-[56px] h-[56px] rounded-full bg-gradient-to-br from-[#007bff] to-[#0056b3] text-white text-[28px] z-[1001] flex items-center justify-center cursor-pointer border-[3px] border-white transition-all duration-150"
            style="
                box-shadow:
                    0 6px 0 #003d82,
                    0 8px 15px rgba(0, 0, 0, 0.4);
            "
            onmouseover="this.style.transform='translateY(2px)'; this.style.boxShadow='0 4px 0 #003d82, 0 6px 12px rgba(0, 0, 0, 0.4)';"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 0 #003d82, 0 8px 15px rgba(0, 0, 0, 0.4)';"
            onmousedown="this.style.transform='translateY(4px)'; this.style.boxShadow='0 2px 0 #003d82, 0 4px 8px rgba(0, 0, 0, 0.4)';"
        >
            üí¨
            <span
                id="chatNotif"
                class="hidden absolute top-[8px] right-[8px] w-[14px] h-[14px] bg-[#ff4444] rounded-full"
            ></span>
        </button>
        <!-- Modale chat -->
        <div
            id="chatModal"
            class="hidden fixed bottom-[100px] right-[32px] w-[340px] max-w-[95vw] h-[420px] max-h-[80vh] bg-gradient-to-br from-[#1a1a2e] to-[#16213e] rounded-[20px] border-[4px] border-white z-[1002] flex flex-col overflow-hidden"
            style="
                box-shadow:
                    0 8px 0 #0a0a15,
                    0 10px 30px rgba(0, 0, 0, 0.7);
            "
        >
            <div
                class="bg-gradient-to-r from-[#ffcc00] to-[#ff9900] px-6 py-3 font-bold flex items-center justify-between border-b-[3px] border-white"
            >
                <span
                    class="text-black tracking-wider uppercase text-base font-extrabold"
                    >üí¨ Chat de la salle</span
                >
                <button
                    id="closeChat"
                    class="bg-white text-black w-[32px] h-[32px] rounded-full cursor-pointer hover:bg-[#ffcccc] transition font-bold flex items-center justify-center pb-[5px]"
                    style="
                        box-shadow:
                            0 3px 0 #cc7700,
                            0 4px 8px rgba(0, 0, 0, 0.3);
                        font-size: 28px;
                        line-height: 1;
                    "
                    onmouseover="this.style.transform='translateY(1px)'; this.style.boxShadow='0 2px 0 #cc7700, 0 3px 6px rgba(0, 0, 0, 0.3)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 3px 0 #cc7700, 0 4px 8px rgba(0, 0, 0, 0.3)';"
                    onmousedown="this.style.transform='translateY(2px)'; this.style.boxShadow='0 1px 0 #cc7700, 0 2px 4px rgba(0, 0, 0, 0.3)';"
                >
                    √ó
                </button>
            </div>
            <div
                id="chatMessages"
                class="flex-1 overflow-y-auto pt-4 px-4 bg-[#0f0f1e]"
                style="height: 320px"
            ></div>
            <form
                id="chatForm"
                class="flex gap-2 p-3 bg-gradient-to-r from-[#1a1a2e] to-[#16213e] border-t-[3px] border-white"
            >
                <input
                    id="chatInput"
                    type="text"
                    maxlength="500"
                    placeholder="Votre message..."
                    autocomplete="off"
                    class="flex-1 px-3 py-2 rounded-lg bg-[#0f0f1e] text-white border-[2px] border-[#ffcc00] outline-none focus:ring-2 focus:ring-[#ffcc00] focus:border-[#ff9900] transition font-medium"
                />
                <button
                    type="submit"
                    class="bg-gradient-to-br from-[#ffcc00] to-[#ff9900] text-black px-3 py-2 rounded-lg font-bold uppercase text-xs border-[3px] border-white transition-all duration-150 whitespace-nowrap"
                    style="
                        box-shadow:
                            0 4px 0 #cc7700,
                            0 6px 10px rgba(0, 0, 0, 0.4);
                    "
                    onmouseover="this.style.transform='translateY(1px)'; this.style.boxShadow='0 3px 0 #cc7700, 0 4px 8px rgba(0, 0, 0, 0.4)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 0 #cc7700, 0 6px 10px rgba(0, 0, 0, 0.4)';"
                    onmousedown="this.style.transform='translateY(3px)'; this.style.boxShadow='0 1px 0 #cc7700, 0 3px 6px rgba(0, 0, 0, 0.4)';"
                >
                    Envoyer
                </button>
            </form>
        </div>

        <!-- Modale EXIT - F√©licitations -->
        <div
            id="exitModal"
            class="hidden fixed inset-0 bg-black/80 z-[1003] flex items-center justify-center p-4"
        >
            <div
                class="bg-gradient-to-br from-[#1a1a2e] to-[#16213e] rounded-[20px] border-[4px] border-[#ffcc00] max-w-[600px] w-full max-h-[90vh] overflow-y-auto"
                style="
                    box-shadow:
                        0 10px 0 #cc9900,
                        0 15px 40px rgba(255, 204, 0, 0.5);
                "
            >
                <div
                    class="bg-gradient-to-r from-[#ffcc00] to-[#ff9900] px-6 py-4 text-center border-b-[3px] border-white"
                >
                    <h2
                        class="text-black text-2xl font-extrabold uppercase tracking-wider"
                    >
                        üé¨ F√©licitations! üé¨
                    </h2>
                </div>

                <div class="p-6 text-white space-y-4">
                    <p class="text-lg font-bold text-[#ffcc00] text-center">
                        Vous avez r√©solu toutes les √©nigmes!
                    </p>

                    <p class="text-base leading-relaxed">
                        Vous venez de d√©couvrir les fondamentaux de la
                        r√©alisation cin√©matographique. Chaque √©nigme que vous
                        avez r√©solue repr√©sente un pilier essentiel de la
                        cr√©ation d'un film:
                    </p>

                    <div class="space-y-3">
                        <div class="bg-[#0f0f1e] p-4 rounded-lg border-l-4 border-[#ffcc00]">
                            <h3 class="font-bold text-[#ffcc00] mb-2">
                                üìã Le Storyboard
                            </h3>
                            <p class="text-sm">
                                C'est la vision du r√©alisateur, le plan qui
                                guide chaque plan du film. Sans storyboard, un
                                film manque de coh√©rence narrative et de
                                direction artistique.
                            </p>
                        </div>

                        <div class="bg-[#0f0f1e] p-4 rounded-lg border-l-4 border-[#ffcc00]">
                            <h3 class="font-bold text-[#ffcc00] mb-2">
                                üí° L'√âclairage
                            </h3>
                            <p class="text-sm">
                                La lumi√®re cr√©e l'atmosph√®re, guide l'√©motion
                                et r√©v√®le la beaut√© de chaque plan. C'est elle
                                qui transforme une sc√®ne ordinaire en moment
                                cin√©matographique m√©morable.
                            </p>
                        </div>

                        <div class="bg-[#0f0f1e] p-4 rounded-lg border-l-4 border-[#ffcc00]">
                            <h3 class="font-bold text-[#ffcc00] mb-2">
                                üé≠ Le Casting
                            </h3>
                            <p class="text-sm">
                                Les acteurs donnent vie aux personnages. Le bon
                                casting peut faire la diff√©rence entre un film
                                ordinaire et un chef-d'≈ìuvre inoubliable.
                            </p>
                        </div>
                    </div>

                    <p class="text-base leading-relaxed pt-2">
                        Ensemble, ces √©l√©ments forment la base de tout grand
                        film. Vous avez d√©montr√© votre compr√©hension de ces
                        concepts essentiels. Vous √™tes maintenant pr√™ts √† cr√©er
                        votre propre chef-d'≈ìuvre!
                    </p>

                    <div class="flex justify-center pt-4">
                        <button
                            onclick="document.getElementById('exitModal').style.display='none'"
                            class="bg-gradient-to-br from-[#ffcc00] to-[#ff9900] text-black px-6 py-3 rounded-lg font-bold uppercase tracking-wide border-[3px] border-white transition-all duration-150"
                            style="
                                box-shadow:
                                    0 6px 0 #cc7700,
                                    0 8px 15px rgba(0, 0, 0, 0.4);
                            "
                            onmouseover="this.style.transform='translateY(2px)'; this.style.boxShadow='0 4px 0 #cc7700, 0 6px 12px rgba(0, 0, 0, 0.4)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 0 #cc7700, 0 8px 15px rgba(0, 0, 0, 0.4)';"
                            onmousedown="this.style.transform='translateY(4px)'; this.style.boxShadow='0 2px 0 #cc7700, 0 4px 8px rgba(0, 0, 0, 0.4)';"
                        >
                            Fermer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
        <script src="/assets/scenes/main.js"></script>
        <script src="/assets/scenes/enigma1.js"></script>
        <script src="/assets/scenes/enigma2.js"></script>
        <script src="/assets/scenes/enigma3.js"></script>
        <script src="/assets/scenes/enigma4.js"></script>
        <script src="/assets/scenes/gameover.js"></script>
        <script src="/assets/main.js"></script>
        <script src="/assets/room.js"></script>
    </body>
</html>
