<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <title>Escape Game - Accueil</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                background: #222;
                color: #fff;
            }
            .container {
                max-width: 400px;
                margin: 60px auto;
                background: #333;
                padding: 30px;
                border-radius: 8px;
            }
            input,
            button {
                width: 100%;
                margin: 10px 0;
                padding: 10px;
                border-radius: 4px;
                border: none;
            }
            button {
                background: #007bff;
                color: #fff;
                cursor: pointer;
            }
            button:hover {
                background: #0056b3;
            }
            .error {
                color: #ff4444;
                margin-top: 10px;
            }
        </style>
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    </head>
    <body>
        <div class="container">
            <h2>Escape Game</h2>
            <input type="text" id="pseudo" placeholder="Pseudo" />
            <button id="createBtn">Cr√©er une salle</button>
            <hr />
            <input
                type="text"
                id="roomCode"
                placeholder="Code salle (A-Z0-9)"
                maxlength="6"
            />
            <button id="joinBtn">Rejoindre</button>
            <div class="error" id="errorMsg"></div>
        </div>
        <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
        <script src="/assets/main.js"></script>
        <script>
            document.getElementById("createBtn").onclick = async () => {
                const pseudo = document.getElementById("pseudo").value.trim();
                if (!pseudo) return showError("Pseudo requis");

                let code = await createRoom(pseudo);
                if (code === null) return showError("Erreur serveur");

                localStorage.setItem("roomCode", code);
                localStorage.setItem("pseudo", pseudo);
                window.location = "/room.html";
            };

            document.getElementById("joinBtn").onclick = async () => {
                const pseudo = document.getElementById("pseudo").value.trim();
                const code = document
                    .getElementById("roomCode")
                    .value.trim()
                    .toUpperCase();
                if (!pseudo || !code) return showError("Pseudo et code requis");

                localStorage.setItem("roomCode", code);
                localStorage.setItem("pseudo", pseudo);
                window.location = "/room.html";
            };

            function showError(msg) {
                document.getElementById("errorMsg").textContent = msg;
            }
        </script>
    </body>
</html>
